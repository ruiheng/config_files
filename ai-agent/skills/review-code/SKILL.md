---
name: review-code
description: Reviews code changes for logical correctness, design quality, and security. Use after code has been written to validate implementation quality.
---

# Review Code

Review code changes for logical correctness, design quality, and security.

## Input

Provide one of the following:
1. A `review-request-*.md` file (generated by the implementer after task completion), OR
2. The original task description + implementation summary + code changes

## Input Completeness Gate (Required)

Before reviewing code quality, verify the input includes enough context:
- Scope is explicit (uncommitted / commit / branch and target)
- Review focus or risk angles are stated (for example: compatibility, security boundaries, data migration, performance regression)
- Verification evidence is present (tests run, results, and known coverage gaps)

If critical context is missing, mark the review as `NEEDS_REVISION` and list missing items in `Critical Issues`.
Do not fabricate evidence or assumptions.

## What to Review

- **Logic**: Correct implementation of requirements
- **Design**: Appropriate abstractions, minimal coupling
- **Security**: Injection risks, unsafe operations, data leaks
- **Edge Cases**: Boundary condition handling
- **Maintainability**: Code readability, self-documenting where reasonable
- **Compatibility/Regression Risk**: Backward compatibility and unintended behavior changes
- **Verification Coverage**: Whether provided tests/evidence support the claimed behavior

## What NOT to Review

- Syntax validity (linters handle this)
- Style/formatting (formatters handle this)
- Typos in comments/strings

## Output Format

```markdown
### Summary
[APPROVED / NEEDS_REVISION]: Brief rationale (1-2 sentences)

### Request Completeness Check
- Scope clarity: [PASS / FAIL]
- Review focus/risk angles: [PASS / FAIL]
- Verification evidence: [PASS / FAIL]
If any FAIL, explain why in `Critical Issues`.

### Critical Issues
Must fix before merge:
- [ ] **[CATEGORY]**: Description | Suggestion: How to fix
If none, write: `- None.`

### Design Concerns
Architecture/decision questions:
- **[Concern]**: Description | Suggestion: Alternative approach
If none, write: `- None.`

### Minor Suggestions
Optional improvements:
- [ ] Description
If none, write: `- None.`

### Security Check
- Injection risks: [PASS / FAIL / UNKNOWN] - [brief basis]
- Unsafe data exposure: [PASS / FAIL / UNKNOWN] - [brief basis]
- Input validation: [PASS / FAIL / UNKNOWN] - [brief basis]

### Verification Questions
For the implementer/author:
- [Q1] Question
```

## Guidelines

1. Be specific: Reference line numbers or function names
2. Explain why: Describe the problem, not just that something is wrong
3. Suggest fixes: Offer concrete improvements
4. Distinguish severity: Separate blockers from suggestions
5. Assume good intent: Review the code, not the author
6. Stay focused: Review what was asked, not what could be
7. If no critical findings, explicitly state that and mention residual risks/testing gaps
8. Keep output copy/paste friendly: produce a standalone Markdown report with no chat-specific framing
9. Avoid second-person pronouns (`you`, `your`, `你`, `你的`); use neutral references such as `author`, `implementer`, or `submission`
10. Treat missing scope/focus/evidence as review blockers when they prevent reliable judgment
11. Never invent test results, risk assumptions, or implementation details not present in the input
